<!DOCTYPE html>
<html>
<head>
    <title>Murder Mystery Admin Panel</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.0/socket.io.js"></script>
    <style>

        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin: 0;
            padding: 20px;
            background-color: #f0f0f0;
        }
        .victory-button {
            padding: 20px;
            margin: 10px;
            font-size: 18px;
            cursor: pointer;
            width: 300px;
        }
        
        .murderer-button {
            background-color: #ff0000;
            color: white;
        }
        
        .innocent-button {
            background-color: #0000ff;
            color: white;
        }
        
        .warning-message {
            color: red;
            font-weight: bold;
            margin-top: 20px;
            display: none;
        }

        .help-button {
            background-color: #666;
            border: 1px solid #ccc;
            color: white;
            font-size: 20px;
            transition: all 0.3s ease;
        }
        .help-button:hover {
            background: #aaa;
            transform: scale(1.1);
            animation: rotate360 1.5s linear;
        }

        .help-button:not(:hover) {
            animation: unrotate360 1.5s linear;
        }

        .help-button.clicked {
            animation: rotate360 1.5s linear;
            pointer-events: none;
        }

        .help-button.closing {
            animation: unrotate360 1.5s linear;
            pointer-events: none;
        }

        @keyframes rotate360 {
            from {
                transform: rotate(0deg);
            }
            to {
                transform: rotate(-360deg);
            }
        }

        @keyframes unrotate360 {
            from {
                transform: rotate(-360deg);
            }
            to {
                transform: rotate(0deg);
            }
        }        


        #gameOver {
            display: none;
        }

        /* Style du modal */
        .modal {
            display: none; /* Masqu√© par d√©faut */
            position: fixed; /* Reste en place */
            z-index: 1; /* Au-dessus des autres √©l√©ments */
            left: 0;
            top: 0;
            width: 100%; /* Largeur compl√®te */
            height: 100%; /* Hauteur compl√®te */
            overflow: auto; /* Ajoute un d√©filement si n√©cessaire */
            background-color: rgb(0,0,0); /* Couleur de fond noir */
            background-color: rgba(0,0,0,0.4); /* Fond noir avec transparence */
        }

        /* Contenu du modal */
        .modal-content {
            background-color: #fefefe;
            margin: 15% auto; /* 15% du haut et centr√© */
            padding: 20px;
            border: 1px solid #888;
            width: 80%; /* Largeur de 80% */
        }

        /* Bouton de fermeture */
        .close-button {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
        }

        .close-button:hover,
        .close-button:focus {
            color: black;
            text-decoration: none;
            cursor: pointer;
        }

        /* Styles pour le header en d√©grad√© */
        .gradient-header {
            position: relative; /* N√©cessaire pour le positionnement du pseudo-√©l√©ment */
            background: linear-gradient(to right, #800000, #4B0000, #660000, #8B0000, #000080, #000033, #002147, #1B0030);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent; /* Pour le texte */
            color: transparent; /* Valeur de secours */
        }

        .gradient-title {
            background: linear-gradient(to right, #4B0000, #800000, #A00000, #E60000, #FF0000);
            background-clip: text; /* Propri√©t√© standard */
            -webkit-background-clip: text; /* Pr√©fixe pour les navigateurs bas√©s sur WebKit */
            -webkit-text-fill-color: transparent; /* Pr√©fixe pour les navigateurs bas√©s sur WebKit */
            color: transparent; /* Valeur de secours pour les navigateurs qui ne supportent pas background-clip */
        }
    </style>
</head>
<body>
    <div id="adminPanel">
        <button class="victory-button murderer-button" onclick="checkVictory('Meurtriers')">Victoire des meurtriers</button>
        <button class="victory-button innocent-button" onclick="checkVictory('Innocents')">Victoire des innocents</button>
        <button class="victory-button help-button" onclick="pop()">R√®gles</button>
        <button class="victory-button reset-button" onclick="reset()">Recharger le jeu</button>
        <div id="warningMessage" class="warning-message">
            Attention, m√©fies-toi, tout le monde n'est pas mort :/
        </div>
    </div>

    <div id="rulesModal" class="modal">
        <div class="modal-content">
            <span class="close-button">&times;</span>

            <h2 class="gradient-header">R√®gles du jeu Murder Mystery</h2>
            <p>
                Bienvenue dans Murder Mystery ! Voici comment le jeu fonctionne :
            </p>

            <h3 class="gradient-header"><u>Objectif du jeu </u></h3>
            <p>
                L'objectif est de d√©couvrir qui est le(s) meurtrier(s) parmi les joueurs. Les joueurs peuvent avoir diff√©rents r√¥les (comme sh√©rif, m√©decin, cam√©raman, couple), chacun avec ses propres capacit√©s et objectifs. Le jeu se termine lorsque le meurtrier ou les innoncents sont morts ou lorsque le temps est √©coul√©.
            </p>

            <h3 class="gradient-header"><u>R√®gles de base </u></h3>
            <ul>
                <li>Chaque joueur re√ßoit un r√¥le secret au d√©but du jeu.</li>
                <li>Les joueurs doivent interagir, poser des questions et rassembler des indices.</li>
                <li>Les joueurs peuvent "se mettre mort" pour simuler leur mort et cr√©er des myst√®res.</li>
                <li>Les joueurs peuvent v√©rifier les codes des morts pour confirmer les d√©c√®s.</li>
                <li>Le jeu se termine lorsque le meurtrier ou les innoncents sont morts ou que le temps est √©coul√©.</li>
                <li>Lorsque le temps est √©coul√©, le gagnant est d√©sign√© de mani√®re al√©atoire</li>
                <li>Pour terminer la partie, veuillez bien v√©rifier si les codes de d√©c√®s du l'√©quipe ennemies sont rentr√©s et allez √† l'ordinateur pour valider la victoire d'un camp</li> 
            </ul>

            <h3 class="gradient-header"><u>Interdictions et obligations</u></h3>
                <li><b><font color="red">Interdiction</font></b> d'utiliser vos vrais noms et pr√©noms (pour L√©o par exemple, il peut utiliser Diego ou pour Axel le nom de son daron <i>(ah bah nan il n'en a pas üôÉ)</i>)</li>
                <li><b><font color="red">Interdiction</font></b> de rester par groupe de plus de 3 personnes</li>
                <li><b><font color="red">Interdiction</font></b> de rester plus de 15 secondes au m√™me endroit</li> 
                <li><b><font color="red">Interdiction</font></b> de bouger une fois mis "pr√™t".</li>    
                <li><b><font color="red">Interdiction</font></b> de se mettre √† c√¥t√© d'un joueur avant de lancer une partie.</li>
                <li><b><font color="red">Interdiction</font></b> de partager son r√¥le durant la partie.</li>
                <li><b><font color="red">Interdiction</font></b> de se parler par message ailleurs que dans le chat du jeu. (pour le couple)</li>
                <li><b><font color="red">Interdiction</font></b> de se mettre dans le m√™me groupe pour les personnes poss√©dant les 2 armes (sh√©rif + personnes qui a trouv√© la seconde arme)</li>
                <li><b><font color="red">Interdiction</font></b> de d√©voiler o√π se trouve la deuxi√®me arme et d'utiliser l'arme durant la prochaine partie(personne qui l'a cach√©) </li>
                <li><b><font color="red">Interdiction</font></b> de prendre le t√©l√©phone d'une autre personne (sauf si elle est morte et pour rentrer le code)</li>
                <li><b><font color="red">Interdiction</font></b> de former des alliances (sauf pour le couple)</li>
                <li><b><font color="red">Interdiction</font></b> de faire semblant de rentrer le code (si le joueur mort n'a pas encore √©t√© mit dans la liste et que le joueur entrant le code est un meurtrier)</li>
                <li><b><font color="red">Interdiction</font></b> de parler de la mort d'un joueur (sauf si son code a √©t√© scann√©)</li>
                <li><b><font color="red">Interdiction</font></b> de demander le pseudo d'une personne</li>
                <li><b><font color="red">Interdiction</font></b> d'interagir lorsque le popup pour refaire vivre le cam√©raman s'affiche (pour la personne morte, un autre joueur peut interagir sur le t√©l√©phone de la personne vivante)</li> 
                <li><b><font color="blue">Obligation</font></b> de garder son t√©l√©phone allum√© en √©tant mort pour pouvoir rentrer les codes de mort </li>
                <li><b><font color="blue">Obligation</font></b> de rester allong√© par terre quand on est mort et de ne pas bouger ni parler par la suite</li>
                <li><b><font color="blue">Obligation</font></b> de ne pas parler √† une personne morte</li>
                

            <h3 class="gradient-header"><u>Comment jouer </u></h3>
            <p>
                1. Entrez votre pseudo et rejoignez le jeu.
                <br>
                2. Dispersez-vous dans la maison et mettez vous pr√™ts √† jouer.
                <br>
                3. Attendez que tous les joueurs soient pr√™ts.
                <br>
                4. Suivez les instructions √† l'√©cran et interagissez avec les autres joueurs.
                <br>
                5. Essayez de d√©couvrir qui est le(s) meurtrier(s) ou tuer tout les innoncents sans vous faire remarquer avant que le temps ne soit √©coul√©.  
            </p>
            <p>
                Amusez-vous bien et bonne chance !
            </p>

        </div>
    </div>

    <div id="gameOver">
        <h2>Fin du jeu !</h2>
        <p id="gameOverMessage"></p>
        <button onclick="restartGame()">Rejouer</button>
    </div>

    <script>
        const socket = io();
        const modal = document.getElementById("rulesModal");
        const closeButton = document.getElementsByClassName("close-button")[0];
        function checkVictory(winner) {
            $.ajax({
                url: '/check_victory',
                method: 'POST',
                contentType: 'application/json',
                data: JSON.stringify({ winner: winner }),
                success: function(response) {
                    if (response.valid) {
                        $('#adminPanel').hide();
                        $('#gameOver').show();
                        $('#gameOverMessage').text(response.message);
                        socket.emit('end_game', { winner: winner });
                    } else {
                        $('#warningMessage').show();
                        setTimeout(() => $('#warningMessage').hide(), 3000);
                    }
                }
            });
        }

        function restartGame() {
            $.ajax({
                url: '/reset_game',
                method: 'POST',
                success: function() {
                    socket.emit('restart_game');
                    window.close();
                }
            });
        }
    
        function pop() {
            modal.style.display = "block";
        }

        closeButton.onclick = function() {
            modal.style.display = "none";
        }

        // Lorsque l'utilisateur clique n'importe o√π en dehors du modal, fermez-le
        window.onclick = function(event) {
            if (event.target == modal) {
                modal.style.display = "none";
            }
        }

        function reset() {
            if (confirm("√ätes-vous s√ªr de vouloir r√©initialiser la partie ?")) {
                restartGame();
            }
        }
    </script>
</body>
</html>
